[buildout]
extends = buildout.cfg
parts +=
    xmltest
    pep8
    pyflakes
    coverage
    violations

[xmltest]
<= test
recipe = collective.xmltestreport
defaults = ['--tests-pattern', '^f?tests$', '-vv',]

[scripts]
recipe = zc.recipe.egg
eggs =
    ${app:eggs}
    pylint
    coverage

[pep8]
recipe = zc.recipe.egg
eggs = pep8

[pyflakes]
recipe = zc.recipe.egg
eggs =
    pyflakes
scripts = pyflakes
entry-points = pyflakes=pyflakes.scripts.pyflakes:main
arguments = sys.argv[1:]

[violations]
recipe = collective.recipe.cmd
dummy = ${pep8:eggs} ${pyflakes:eggs} # mark dependencies
cmds =
    ${buildout:directory}/bin/pep8 src | perl -ple 's/: [WE]([0-9]+)/: [W$1]/' > violations.txt
    ${buildout:directory}/bin/pyflakes src | perl -ple 's/: /: [E] /' >> violations.txt
on_update = true
on_install = true

[coverage]
<= scripts
entry-points =
    coverage=coverage.cmdline:main
arguments = [
        'run',
        '--include=*bioport_repository*',
        '--include=*bioport*',
        '--include=*biodes*',
        '--include=*gerbrandyutils*',
        '--omit=*tests*'
        ] + sys.argv[1:]


[versions]
coverage = 3.4
plone.recipe.command = 1.1
pep8 = 0.6.0


